<!DOCTYPE html>
<html>
<head>
	<script src="http://code.jquery.com/jquery-1.9.1.js"></script>

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

	<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
</head>
<body>

<div ng-app="" ng-controller="nodeController"> 			
	<div class="row">
		<div class="col-xs-6 col-md-5 panel panel-default">
			<div class="panel-heading">External node</div>
			<div class="panel-body">
				</br>
				<button class="btn btn-default" ng-click=""> 
				test alive
				</button>
				</br>
				<label for="inputTest" class="col-sm-2 control-label">id</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{selectedNode.id}}>
				
				</br>
				<label for="inputTest" class="col-sm-2 control-label">ip</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{selectedNode.ip}}>
				
				</br>
				<label for="inputTest" class="col-sm-2 control-label">port</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{selectedNode.port}}>
				
				</br>
				<label for="inputTest" class="col-sm-2 control-label">successor</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{selectedNode.successor.id}}>
				
				</br>
				<label for="inputTest" class="col-sm-2 control-label">predecessor</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{selectedNode.predecessor.id}}>
				
				</br>
			</div>
		</div>

		<div class="col-xs-6 col-md-5 panel panel-default">
			<div class="panel-heading">Personnal node</div>
			<div class="panel-body">
				</br>
				<button class="btn btn-default" ng-if="!nodeIsSelected" ng-click=""> 
					insert node
				</button>
				</br>
				<button class="btn btn-default" ng-if="nodeIsSelected" ng-click=""> 
					remove node
				</button>
				</br>

				<label for="inputTest" class="col-sm-2 control-label">id</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{localNode.id}}>		
				</br>
				<label for="inputTest" class="col-sm-2 control-label">ip</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{localNode.ip}}>
				
				</br>
				<label for="inputTest" class="col-sm-2 control-label">port</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{localNode.port}}>
				
				</br>
				<label for="inputTest" class="col-sm-2 control-label">successor</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{localNode.successor.id}}>
				
				</br>
				<label for="inputTest" class="col-sm-2 control-label">predecessor</label>	
				<input type="ipTest" class="form-control" id="inputPassword" placeholder={{localNode.predecessor.id}}>				
				</br>
			</div>
		</div>

		<div class="col-xs-12 col-md-8 panel panel-default">
			<div class="panel-body">
			future graph visualisation
			</br>
			nodes : {{nodes}}
			</br>
			local : {{localNode}}
			</br>
			<button class="btn btn-default" ng-click="getAllNodes()" ng-init="init()"> 
				maj general data
			</button>
			</div>
		</div>
	</div>
</div>

<script>
function nodeController($scope,$http) {
	$scope.init = function () {           
        $scope.nodeIsSelected = false;

        var urlReq = 'http://' + '127.0.0.1' + ':' + '3000' + '/nodes';
		$http({
			method: 'GET', 
			url: urlReq,
			respondType: 'json',
			headers: {
			'Accept': 'application/json',
			'Content-Type': 'application/json',
			'Access-Control-Allow-Origin' : '*',
			'Access-Control-Allow-Credentials': true
		}}).
		success(function(data, status, headers, config) {
			$scope.nodes = data;
			$scope.localNode = $scope.nodes;
			$scope.status = status;
		}).
		error(function(data, status, headers, config) {
			$scope.nodes = data;
			$scope.localNode = $scope.nodes;
			$scope.status = status;
		});

        console.log($scope.localNode);        
    }

    $scope.getAllNodes = function (){
    	var urlReq = 'http://' + '127.0.0.1' + ':' + '3000' + '/nodes';
		$http({
			method: 'GET', 
			url: urlReq,
			respondType: 'json',
	        headers: {
	             'Accept': 'application/json',
	             'Content-Type': 'application/json',
	             'Access-Control-Allow-Origin' : '*',
	             'Access-Control-Allow-Credentials': true
	        }}).
		success(function(data, status, headers, config) {
			$scope.nodes = data;
			$scope.status = status;
		}).
		error(function(data, status, headers, config) {
			$scope.nodes = data;
			$scope.status = status;
	  });
	}

	$scope.getNode = function (ident, ip, port, local){
		if (local){
            var urlReq = 'http://' + '127.0.0.1' + ':' + '3000' + '/nodes/' + ident;
			$http({
				method: 'GET', 
				url: urlReq ,
				respondType: 'json',
		        headers: {
					'Accept': 'application/json',
					'Content-Type': 'application/json',
					'Access-Control-Allow-Origin' : '*',
					'Access-Control-Allow-Credentials': true
	        }}).
			success(function(data, status, headers, config) {		
				$scope.localNode = data;
				$scope.selectedNode = data;
				$scope.nodeIsSelected = true;					
				$scope.status = status;
			}).
			error(function(data, status, headers, config) {
				$scope.status = status;
			});
		}
		else{
            var urlReq ='http://' + '127.0.0.1' + ':' + '3000' + '/nodes/' + ident;
			$http({
				method: 'GET', 
				url: urlReq ,
				respondType: 'json',
		        headers: {
					'Accept': 'application/json',
					'Content-Type': 'application/json',
					'Access-Control-Allow-Origin' : '*',
					'Access-Control-Allow-Credentials': true
	        }}).
			success(function(data, status, headers, config) {		
				$scope.selectedNode = data;
				$scope.nodeIsSelected = true;					
				$scope.status = status;
			}).
			error(function(data, status, headers, config) {
				$scope.status = status;
			});
		}
	}
}
</script>

</body>
</html>
